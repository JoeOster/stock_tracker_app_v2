const express = require(\'express\');\nconst router = express.Router();\nconst db = require(\'../database\');\nconst { authenticateToken } = require(\'../services/authService\');\n\n// Get user's watchlist\nrouter.get(\'/watchlist\', authenticateToken, async (req, res) => {\n  try {\n    const userId = req.user.id;\n    const watchlist = await db.getWatchlist(userId);\n    res.json(watchlist);\n  } catch (err) {\n    console.error(\'Error fetching watchlist:\', err);\n    res.status(500).json({ message: \'Server error\', error: err.message });\n  }\n});\n\n// Add a ticker to watchlist\nrouter.post(\'/watchlist\', authenticateToken, async (req, res) => {\n  const { ticker } = req.body;\n  const userId = req.user.id;\n\n  if (!ticker) {\n    return res.status(400).json({ message: \'Ticker symbol is required.\' });\n  }\n\n  try {\n    await db.addWatchlistItem(userId, ticker);\n    res.status(201).json({ message: \'Ticker added to watchlist.\' });\n  } catch (err) {
    if (err.message.includes(\'UNIQUE constraint failed\')) {
      return res.status(409).json({ message: \'Ticker already in watchlist.\' });
    }
    console.error(\'Error adding ticker to watchlist:\', err);
    res.status(500).json({ message: \'Server error\', error: err.message });\n  }\n});\n\n// Remove a ticker from watchlist\nrouter.delete(\'/watchlist/:ticker\', authenticateToken, async (req, res) => {\n  const { ticker } = req.params;\n  const userId = req.user.id;\n\n  try {\n    await db.removeWatchlistItem(userId, ticker);\n    res.json({ message: \'Ticker removed from watchlist.\' });\n  } catch (err) {\n    console.error(\'Error removing ticker from watchlist:\', err);\n    res.status(500).json({ message: \'Server error\', error: err.message });\n  }\n});\n\nmodule.exports = router;\n